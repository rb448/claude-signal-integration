============================= test session starts ==============================
platform darwin -- Python 3.13.6, pytest-9.0.2, pluggy-1.6.0
rootdir: /Users/rossbrown/Desktop/DevProjects/Claude/claude-signal-integration
configfile: pyproject.toml
testpaths: tests
plugins: asyncio-1.3.0, cov-7.0.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 498 items

tests/test_approval_commands.py ...........                              [  2%]
tests/test_approval_detector.py ............                             [  4%]
tests/test_approval_manager.py ..................                        [  8%]
tests/test_approval_workflow.py ...............                          [ 11%]
tests/test_attachment_handler.py .................                       [ 14%]
tests/test_auth.py ............                                          [ 17%]
tests/test_claude_bridge.py ......                                       [ 18%]
tests/test_claude_orchestrator.py ..........                             [ 20%]
tests/test_claude_parser.py .....................                        [ 24%]
tests/test_claude_process.py s.....                                      [ 25%]
tests/test_claude_responder.py .................................         [ 32%]
tests/test_code_formatter.py ................                            [ 35%]
tests/test_custom_command_flow.py ......                                 [ 36%]
tests/test_custom_command_integration.py .....                           [ 37%]
tests/test_custom_command_registry.py ...........                        [ 39%]
tests/test_custom_command_syncer.py .........                            [ 41%]
tests/test_custom_commands.py ..............                             [ 44%]
tests/test_daemon.py ......                                              [ 45%]
tests/test_daemon_advanced_features.py ...                               [ 46%]
tests/test_diff_processor.py ...............                             [ 49%]
tests/test_diff_renderer.py .........                                    [ 51%]
tests/test_emergency_approval_integration.py ....                        [ 52%]
tests/test_emergency_auto_approver.py ........                           [ 53%]
tests/test_emergency_auto_committer.py ........                          [ 55%]
tests/test_emergency_commands.py .......                                 [ 56%]
tests/test_emergency_mode.py ........                                    [ 58%]
tests/test_lifecycle.py ..............                                   [ 61%]
tests/test_message_buffer.py .....                                       [ 62%]
tests/test_notification_categorizer.py .........                         [ 63%]
tests/test_notification_commands.py ...............                      [ 66%]
tests/test_notification_formatter.py ..........                          [ 68%]
tests/test_notification_manager.py ........                              [ 70%]
tests/test_notification_preferences.py .............                     [ 73%]
tests/test_queue.py .....                                                [ 74%]
tests/test_rate_limiter.py .......                                       [ 75%]
tests/test_reconnection.py .......                                       [ 76%]
tests/test_recovery.py ........                                          [ 78%]
tests/test_session_commands.py ..............................            [ 84%]
tests/test_session_integration.py ..................                     [ 88%]
tests/test_session_manager.py ........                                   [ 89%]
tests/test_session_sync.py ......                                        [ 90%]
tests/test_signal_client.py ..........                                   [ 92%]
tests/test_syntax_highlighter.py .............                           [ 95%]
tests/test_thread_commands.py ..........                                 [ 97%]
tests/test_thread_mapper.py ............                                 [100%]

=============================== warnings summary ===============================
tests/test_claude_bridge.py::test_send_command
tests/test_claude_bridge.py::test_send_command_encodes_utf8
  /Users/rossbrown/Desktop/DevProjects/Claude/claude-signal-integration/src/claude/bridge.py:53: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    self._process.stdin.write(data)
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/test_daemon_advanced_features.py::test_daemon_startup_with_custom_commands_and_emergency_mode
  /Users/rossbrown/Desktop/DevProjects/Claude/claude-signal-integration/src/daemon/service.py:384: RuntimeWarning: coroutine 'test_daemon_startup_with_custom_commands_and_emergency_mode.<locals>.MockSignalClient.receive_messages' was never awaited
    async for message in self.signal_client.receive_messages():
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/test_daemon_advanced_features.py::test_daemon_startup_logs_component_status
  /Users/rossbrown/Desktop/DevProjects/Claude/claude-signal-integration/src/daemon/service.py:384: RuntimeWarning: coroutine 'test_daemon_startup_logs_component_status.<locals>.MockSignalClient.receive_messages' was never awaited
    async for message in self.signal_client.receive_messages():
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform darwin, python 3.13.6-final-0 _______________

Name                               Stmts   Miss  Cover   Missing
----------------------------------------------------------------
src/approval/__init__.py               2      0   100%
src/approval/commands.py              40      3    92%   44, 50, 62
src/approval/detector.py              23      0   100%
src/approval/manager.py               46      0   100%
src/approval/models.py                 6      0   100%
src/approval/workflow.py              48      2    96%   122, 160
src/auth/phone_verifier.py            38      0   100%
src/claude/__init__.py                 4      0   100%
src/claude/bridge.py                  23      2    91%   47, 72
src/claude/code_formatter.py          56      1    98%   59
src/claude/diff_processor.py         136     13    90%   73, 98-100, 221-222, 230-231, 235-240
src/claude/diff_renderer.py           73      0   100%
src/claude/orchestrator.py            81     22    73%   93-97, 109-132, 163, 170, 186, 228-229, 241-242
src/claude/parser.py                  69      0   100%
src/claude/process.py                 46     14    70%   84-86, 101-102, 105-106, 117-122, 147-152
src/claude/responder.py              141     16    89%   69, 80, 121, 215-229
src/claude/syntax_highlighter.py      17      0   100%
src/custom_commands/__init__.py        3      0   100%
src/custom_commands/commands.py       79      1    99%   69
src/custom_commands/registry.py       56      4    93%   23-25, 33
src/custom_commands/syncer.py        102      5    95%   57, 226-227, 232-233
src/daemon/__init__.py                 2      0   100%
src/daemon/service.py                225     65    71%   140, 144-153, 157-159, 177-178, 188-215, 342-355, 406-419, 437-438, 460-461, 467-500, 504
src/emergency/__init__.py              2      0   100%
src/emergency/auto_approver.py        14      0   100%
src/emergency/auto_committer.py       34      6    82%   42, 88-93, 113-121
src/emergency/commands.py             40      2    95%   105-106
src/emergency/mode.py                 52      2    96%   122, 140
src/notification/__init__.py           3      0   100%
src/notification/categorizer.py        9      0   100%
src/notification/commands.py          65      2    97%   128, 163
src/notification/formatter.py         77     10    87%   115, 130, 137, 144-146, 151, 154-156
src/notification/manager.py           35      2    94%   117-122
src/notification/preferences.py       58      1    98%   43
src/notification/types.py              6      0   100%
src/session/__init__.py                5      0   100%
src/session/commands.py              173     17    90%   92, 105, 123, 228-240, 392, 426-427, 435-436, 440-441
src/session/lifecycle.py              19      1    95%   82
src/session/manager.py               132     11    92%   262-276, 304, 349, 373
src/session/recovery.py               23      0   100%
src/session/sync.py                   41      0   100%
src/signal/__init__.py                 1      0   100%
src/signal/attachment_handler.py      63      3    95%   175-183
src/signal/client.py                 143     65    55%   51-73, 77-81, 111-119, 158, 192, 204-240, 260, 273-305, 311-312, 322-329, 338
src/signal/message_buffer.py          20      0   100%
src/signal/queue.py                   56      7    88%   46-52, 65-66, 97-98, 108
src/signal/rate_limiter.py            76      0   100%
src/signal/reconnection.py            26      1    96%   90
src/thread/__init__.py                 3      0   100%
src/thread/commands.py                60      3    95%   73, 103, 129
src/thread/mapper.py                  78      1    99%   52
----------------------------------------------------------------
TOTAL                               2630    282    89%
================= 497 passed, 1 skipped, 4 warnings in 30.11s ==================
